# Azure AD App Registration Configuration
# Required for Azure authentication functionality

# Get these values from your Azure AD App Registration:
# 1. Go to Azure Portal > Azure Active Directory > App registrations
# 2. Create a new registration or select existing one
# 3. Copy the Application (client) ID
AZURE_CLIENT_ID=your-client-id-here

# 4. Go to "Certificates & secrets" and create a new client secret
# 5. Copy the secret value (not the Secret ID)
AZURE_CLIENT_SECRET=your-client-secret-here

# 6. Copy the Directory (tenant) ID from the Overview page
# Use 'common' to allow users from any Azure AD tenant
AZURE_TENANT_ID=common

# Flask secret key for session management
# Generate a random value: python -c "import os; print(os.urandom(24).hex())"
FLASK_SECRET_KEY=your-generated-secret-key-here

# External URL (required when behind reverse proxy)
# This is your public-facing HTTPS URL without trailing slash
# MUST match the redirect URI registered in Azure AD
# Example: https://certificate-tools.soep.org
EXTERNAL_URL=https://certificate-tools.soep.org

# ==============================================================================
# SETUP INSTRUCTIONS
# ==============================================================================
# 
# 1. Register an Azure AD Application:
#    - Navigate to: https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredApps
#    - Click "New registration"
#    - Name: Certificate Tools (or your preferred name)
#    - Supported account types: Choose based on your needs
#      * "Accounts in this organizational directory only" - Single tenant
#      * "Accounts in any organizational directory" - Multi-tenant
#      * "Accounts in any organizational directory and personal Microsoft accounts" - Multi-tenant + personal
#    - Redirect URI: Web - https://your-domain.com/auth/callback
#      IMPORTANT: Use HTTPS and your actual domain if behind a reverse proxy
#      Examples:
#        * Development: http://localhost:5001/auth/callback
#        * Production: https://cert-tools.example.com/auth/callback
#    - Click "Register"
#
# 2. Configure API Permissions:
#    - Go to "API permissions"
#    - Click "Add a permission"
#    - Select "Azure Key Vault" or "APIs my organization uses" and search for "Azure Key Vault"
#    - Add "user_impersonation" permission
#    - Click "Grant admin consent" (if you have admin rights)
#
# 3. Create Client Secret:
#    - Go to "Certificates & secrets"
#    - Click "New client secret"
#    - Add description and expiration period
#    - Copy the secret VALUE immediately (it won't be shown again!)
#
# 4. Copy this file to .env and fill in the values:
#    cp .env.example .env
#
# 5. Important: Add .env to .gitignore to keep secrets secure!
#
# ==============================================================================
# ADDITIONAL NOTES
# ==============================================================================
#
# - Users must have appropriate permissions on the Azure Key Vault to access certificates
# - Key Vault access policies or RBAC must be configured to allow certificate operations
# - The user's Azure AD account will be used to authenticate to Key Vault
# - For production, use a proper domain and configure the redirect URI accordingly
# - Consider using Azure Key Vault to store the CLIENT_SECRET for production deployments
#
# REVERSE PROXY SETUP:
# - The application is configured to work behind a reverse proxy (nginx, Apache, etc.)
# - IMPORTANT: Set EXTERNAL_URL to your public HTTPS domain (required for OAuth)
# - The application trusts X-Forwarded-Host, X-Forwarded-Proto, X-Forwarded-For headers
# - Make sure your reverse proxy sets these headers:
#     proxy_set_header X-Forwarded-Host $host;
#     proxy_set_header X-Forwarded-Proto $scheme;
#     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#
# For your setup (certificate-tools.soep.org):
# - EXTERNAL_URL should be: https://certificate-tools.soep.org
# - Azure AD redirect URI should be: https://certificate-tools.soep.org/auth/callback
#
