<button class="lg:hidden fixed top-4 left-4 z-50 bg-orange-600 hover:bg-orange-700 text-white p-3 shadow-lg transition-colors" onclick="toggleMenu()">â˜°</button>

<div class="fixed lg:sticky lg:top-0 inset-y-0 left-0 w-64 bg-neutral-900 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out z-40 shadow-2xl lg:h-screen" id="sidebar">
    <div class="p-6 border-b border-neutral-800">
        <h2 class="text-xl font-bold text-orange-500">ğŸ” Certificate Tools</h2>
    </div>
    
    <!-- User Info Section -->
    {% if user %}
    <div class="p-4 border-b border-neutral-800 bg-neutral-800">
        <div class="flex items-center mb-2">
            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold mr-2">
                {{ user.name[0] if user.name else 'U' }}
            </div>
            <div class="flex-1 min-w-0">
                <p class="text-sm font-medium text-white truncate">{{ user.name or 'User' }}</p>
                <p class="text-xs text-gray-400 truncate">{{ user.preferred_username or user.email or '' }}</p>
            </div>
        </div>
        <a href="/logout" class="block w-full text-center text-sm bg-red-600 hover:bg-red-700 text-white py-1 px-2 rounded transition-colors">
            Sign Out
        </a>
    </div>
    {% else %}
    <div class="p-4 border-b border-neutral-800 bg-neutral-800">
        <a href="/login" class="block w-full text-center text-sm bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded transition-colors">
            ğŸ” Sign in with Azure
        </a>
    </div>
    {% endif %}
    
    <nav class="mt-4">
        <ul class="space-y-1">
            <li><a href="/" class="flex items-center px-6 py-3 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors border-l-4 {% if active_page == 'home' %}bg-gray-700 text-orange-500 border-orange-500{% else %}border-transparent{% endif %}"><span class="text-lg mr-3">ğŸ </span>Home</a></li>
            <li><a href="/csr-generator" class="flex items-center px-6 py-3 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors border-l-4 {% if active_page == 'csr-generator' %}bg-gray-700 text-orange-500 border-orange-500{% else %}border-transparent{% endif %}"><span class="text-lg mr-3">ğŸ”‘</span>Generate CSR</a></li>
            <li><a href="/csr-decoder" class="flex items-center px-6 py-3 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors border-l-4 {% if active_page == 'csr-decoder' %}bg-gray-700 text-orange-500 border-orange-500{% else %}border-transparent{% endif %}"><span class="text-lg mr-3">ğŸ”</span>Decode CSR</a></li>
            <li><a href="/csr-signer" class="flex items-center px-6 py-3 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors border-l-4 {% if active_page == 'csr-signer' %}bg-gray-700 text-orange-500 border-orange-500{% else %}border-transparent{% endif %}"><span class="text-lg mr-3">âœï¸</span>Sign CSR</a></li>
            <li><a href="/pfx-converter" class="flex items-center px-6 py-3 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors border-l-4 {% if active_page == 'pfx-converter' %}bg-gray-700 text-orange-500 border-orange-500{% else %}border-transparent{% endif %}"><span class="text-lg mr-3">ğŸ”„</span>PEM to PFX</a></li>
            <li><a href="/pfx-to-pem" class="flex items-center px-6 py-3 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors border-l-4 {% if active_page == 'pfx-to-pem' %}bg-gray-700 text-orange-500 border-orange-500{% else %}border-transparent{% endif %}"><span class="text-lg mr-3">ğŸ“¦</span>PFX to PEM</a></li>
        </ul>
    </nav>

    <!-- Azure Services Separator -->
    {% if user %}
    <div class="px-6 py-3 mt-6">
        <div class="flex items-center">
            <div class="flex-grow border-t border-neutral-700"></div>
            <span class="flex-shrink mx-3 text-xs font-semibold text-gray-500 uppercase tracking-wider">Azure Services</span>
            <div class="flex-grow border-t border-neutral-700"></div>
        </div>
    </div>
    
    <nav class="mt-4">
        <ul class="space-y-1">
            <li><a href="/csr-signer-akv" class="flex items-center px-6 py-3 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors border-l-4 {% if active_page == 'csr-signer-akv' %}bg-gray-700 text-orange-500 border-orange-500{% else %}border-transparent{% endif %}">
                <span class="text-lg mr-3">âœï¸</span>Sign CSR
                {% if not user %}<span class="ml-auto text-xs bg-blue-600 px-2 py-1 rounded">Login</span>{% endif %}
            </a></li>
            <li><a href="/mosadex-pki" class="flex items-center px-6 py-3 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors border-l-4 {% if active_page == 'mosadex-pki' %}bg-gray-700 text-orange-500 border-orange-500{% else %}border-transparent{% endif %}">
                <span class="text-lg mr-3">â˜ï¸</span>Mosadex PKI
                {% if not user %}<span class="ml-auto text-xs bg-blue-600 px-2 py-1 rounded">Login</span>{% endif %}
            </a></li>
            <li><a href="/certificate-list" class="flex items-center px-6 py-3 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors border-l-4 {% if active_page == 'certificate-list' %}bg-gray-700 text-orange-500 border-orange-500{% else %}border-transparent{% endif %}">
                <span class="text-lg mr-3">ğŸ“œ</span>Certificate List
                {% if not user %}<span class="ml-auto text-xs bg-blue-600 px-2 py-1 rounded">Login</span>{% endif %}
            </a></li>
        </ul>
    </nav>
    {% endif %}

</div>

<!-- Overlay for mobile -->
<div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden lg:hidden" onclick="toggleMenu()"></div>

<script>
    function toggleMenu() {
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('sidebar-overlay');
        sidebar.classList.toggle('-translate-x-full');
        overlay.classList.toggle('hidden');
    }
    
    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', function(event) {
        const sidebar = document.getElementById('sidebar');
        const toggle = document.querySelector('.lg\\:hidden');
        const isClickInside = sidebar.contains(event.target) || toggle.contains(event.target);
        
        if (!isClickInside && window.innerWidth < 1024 && !sidebar.classList.contains('-translate-x-full')) {
            toggleMenu();
        }
    });
</script>
